#!/usr/bin/env bash
echo "
set theSubject to \"Auto eMail with Attachment\" --Subject of the email
set theSender to \"zheng.iao@icloud..com\" --Sender of the email

set theContent to \"Hi,

Please find the document(s) attached below.

Cheers,
Yao

\"
-- set theRecipient to the text returned of (display dialog ¬
	-- "Please input the recipient." default answer ¬
	-- "recipient@email.com" hidden answer false ¬
	-- buttons {"Okay", "Cancel"} ¬
	-- default button ¬
	-- "Okay" with title ¬
	-- "Send eMail AppleScript" with icon note ¬
	-- giving up after 100)

tell application \"Mail\"
	activate
	set theMessage to make new outgoing message with properties {visible:true, sender:theSender, subject:theSubject, content:theContent}
	
	tell theMessage
--  make new to recipient with properties {address:theRecipient}
		try
    make new attachment with properties {file name:((\"$1\" as POSIX file) as alias)} at after the last word of the last paragraph
			set message_attachment to 0
		on error errmess -- oops
			log errmess -- log the error
			set message_attachment to 1
		end try
		log \"message_attachment = \" & message_attachment
	end tell
  -- send theMessage
end tell
" | osascript
